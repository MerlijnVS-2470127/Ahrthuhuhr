<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('../partials/FS_Standard_Head'); %>
    <title>Group chat: <%= groupId %></title>
    <script>
      // hier kan vs code een syntax error geven, maar dat komt doordat het ejs binnen <script> niet herkend
      window.__CHAT = {
      groupId: "<%= groupId %>",
      groupName: "<%= group.name %>",
      lastFetch: <%= messages.length ? messages[messages.length - 1].created_at : 0 %>
      };
      window.eventsInfo = <%- JSON.stringify(events) %>;
    </script>
    <script src="/js/FS_Groupchat.js" defer></script>

    <link rel="stylesheet" href="/css/FS_Groupchat.css" />
  </head>

  <header><%- include('../partials/FS_Header'); %></header>

  <div class="main-content-wrapper">
    <body>
      <div class="main_div">
        <!--<main class="container" style="max-width: 900px; margin: 2rem auto">-->
        <div class="page_header">Group: <%= group.name %></div>
        <!-- <h2>Group: <%= groupId %></h2> -->

        <div class="chat_division" style="width: 60%">
          <section id="chat" class="chat">
            <div id="messages" class="messages" aria-live="polite">
              <% messages.forEach(msg => { %>
              <div class="message" data-id="<%= msg.id %>">
                <div class="meta">
                  <strong><%= msg.user_name %></strong> â€” <%= new
                  Date(msg.created_at).toLocaleString() %>
                </div>
                <div class="content"><%= msg.content %></div>
              </div>
              <% }) %>
            </div>

            <form id="composer" class="composer" onsubmit="return false;">
              <input
                type="text"
                id="user_name"
                placeholder="Your name (optional)"
                value="Anonymous"
              />
              <input
                type="text"
                id="content"
                placeholder="Type a message..."
                autocomplete="off"
              />
              <button id="sendBtn">Send</button>
            </form>
          </section>
        </div>

        <div class="chat_division" id="side-panel" style="max-width: 30%">
          <section>
            <h1 class="card-title" id="sp-title">Events</h1>
            <div class="mb-2 sp-description">
              <small
                class="badge bg-light text-muted"
                id="sp-description"
                style="font-size: 18px; text-decoration: none"
              >
                Events of the group.
              </small>
            </div>
            <div
              class="card sp-contents"
              id="sp-contents"
              style="overflow: scroll; max-height: 200px"
            ></div>
            <hr />
            <button id="btn_changeSidePanel" class="btn btn-primary">
              Change
            </button>
          </section>
        </div>
      </div>
    </body>
  </div>

  <footer><%- include('../partials/FS_Footer'); %></footer>
</html>
